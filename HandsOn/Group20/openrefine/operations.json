[
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "zrea",
          "expression": "value",
          "columnName": "zrea",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "MADRID",
                "l": "MADRID"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "zrea",
    "expression": "value",
    "edits": [
      {
        "from": [
          "MADRID"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "Madrid"
      }
    ],
    "description": "Edit cells in bulk in 'zrea' column"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "country",
          "expression": "value",
          "columnName": "country",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "ESPAÑA",
                "l": "ESPAÑA"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "country",
    "expression": "value",
    "edits": [
      {
        "from": [
          "ESPAÑA"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "España"
      }
    ],
    "description": "Edit cells in bulk in 'country' column"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "country",
          "expression": "value",
          "columnName": "country",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "Spain",
                "l": "Spain"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "country",
    "expression": "value",
    "edits": [
      {
        "from": [
          "Spain"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "España"
      }
    ],
    "description": "Edit cells in bulk in 'country' column"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "country",
          "expression": "value",
          "columnName": "country",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "España",
                "l": "España"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        },
        {
          "type": "list",
          "name": "town",
          "expression": "value",
          "columnName": "town",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "MADRID",
                "l": "MADRID"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "town",
    "expression": "value",
    "edits": [
      {
        "from": [
          "MADRID"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "Madrid"
      }
    ],
    "description": "Edit cells in bulk in 'town' column"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "state",
          "expression": "value",
          "columnName": "state",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "ESPAÑA",
                "l": "ESPAÑA"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "state",
    "expression": "value",
    "edits": [
      {
        "from": [
          "ESPAÑA"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "España"
      }
    ],
    "description": "Edit cells in bulk in 'state' column"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "state",
          "expression": "value",
          "columnName": "state",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "Spain",
                "l": "Spain"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "state",
    "expression": "value",
    "edits": [
      {
        "from": [
          "Spain"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "España"
      }
    ],
    "description": "Edit cells in bulk in 'state' column"
  },
  {
    "op": "core/column-addition-by-fetching-urls",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "lat",
    "urlExpression": "grel:\"https://nominatim.openstreetmap.org/reverse?format=json&lat=\" + value + \"&lon=\" + cells['long'].value + \"&addressdetails=1\"",
    "onError": "set-to-blank",
    "newColumnName": "geoData",
    "columnInsertIndex": 13,
    "delay": 500,
    "cacheResponses": true,
    "httpHeadersJson": [
      {
        "name": "authorization",
        "value": ""
      },
      {
        "name": "if-modified-since",
        "value": ""
      },
      {
        "name": "accept-language",
        "value": ""
      },
      {
        "name": "accept-encoding",
        "value": ""
      },
      {
        "name": "user-agent",
        "value": "OpenRefine 3.9.5 [TRUNK]"
      },
      {
        "name": "accept",
        "value": "*/*"
      },
      {
        "name": "accept-charset",
        "value": ""
      }
    ],
    "description": "Create 'geoData' column"
  },
  { "op": "core/column-addition", "engineConfig": { "facets": [], "mode": "row-based" }, "baseColumnName": "geoData", "expression": "grel:if(isBlank(value), \"\", parseJson(value).address.postcode)", "onError": "set-to-blank", "newColumnName": "postalCode", "columnInsertIndex": 14, "description": "Create 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 13, "description": "Move 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 12, "description": "Move 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 11, "description": "Move 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 10, "description": "Move 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 9, "description": "Move 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 8, "description": "Move 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 7, "description": "Move 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 6, "description": "Move 'postalCode' column" },
  { "op": "core/column-move", "columnName": "postalCode", "index": 5, "description": "Move 'postalCode' column" },
  { "op": "core/column-removal", "columnName": "areaCode", "description": "Remove 'areaCode' column" },
  { "op": "core/column-rename", "oldColumnName": "postalCode", "newColumnName": "areaCode", "description": "Rename 'postalCode' to 'areaCode'" },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "emtParking",
          "expression": "value",
          "columnName": "emtParking",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            { "v": { "v": "False", "l": "False" } }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "emtParking",
    "expression": "value",
    "edits": [
      { "from": ["False"], "fromBlank": false, "fromError": false, "to": "false" }
    ],
    "description": "Edit cells in bulk in 'emtParking' column"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "emtParking",
          "expression": "value",
          "columnName": "emtParking",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            { "v": { "v": "True", "l": "True" } }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "emtParking",
    "expression": "value",
    "edits": [
      { "from": ["True"], "fromBlank": false, "fromError": false, "to": "true" }
    ],
    "description": "Edit cells in bulk in 'emtParking' column"
  },
  {
    "op": "core/text-transform",
    "engineConfig": { "facets": [], "mode": "row-based" },
    "columnName": "areaCode",
    "expression": "grel:if(cells['id'].value=='69','28003',value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 1,
    "description": "Set 'areaCode' = 28003 when 'id' == 69"
  },
  {
    "op": "core/column-removal",
    "columnName": "state",
    "description": "Remove 'state' column"
  },
  {
    "op": "core/rename-column",
    "oldColumnName": "id",
    "newColumnName": "identifier",
    "description": "Rename 'id' column to 'identifier'"
  },
  {
    "op": "core/rename-column",
    "oldColumnName": "address",
    "newColumnName": "streetAddress",
    "description": "Rename 'address' column to 'streetAddress'"
  },
  {
    "op": "core/rename-column",
    "oldColumnName": "areaCode",
    "newColumnName": "postalCode",
    "description": "Rename 'areaCode' column to 'postalCode'"
  },
  {
    "op": "core/rename-column",
    "oldColumnName": "zrea",
    "newColumnName": "autonomousCommunity",
    "description": "Rename 'zrea' column to 'autonomousCommunity'"
  },
  {
    "op": "core/rename-column",
    "oldColumnName": "catCode",
    "newColumnName": "categoryCode",
    "description": "Rename 'catCode' column to 'categoryCode'"
  },
  {
    "op": "core/rename-column",
    "oldColumnName": "URLIcono",
    "newColumnName": "URLIcon",
    "description": "Rename 'URLIcono' column to 'URLIcon'"
  },
  {
    "op": "core/rename-column",
    "oldColumnName": "town",
    "newColumnName": "city",
    "description": "Rename 'town' column to 'city'"
  },
  {
    "op": "core/rename-column",
    "oldColumnName": "emtParking",
    "newColumnName": "EMTParking",
    "description": "Rename 'emtParking' column to 'EMTParking'"
  }
]
