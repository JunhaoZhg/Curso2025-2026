@prefix ns: <http://bcn-mobility-air.org/ontology/> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# --------------------------------------------------------------------------
# Q1: Count resources with ns:name (Equivalent to rdfs:label)
# Objetivo: Contar cuántas entidades principales tienen asignada la propiedad ns:name.
# --------------------------------------------------------------------------
SELECT (COUNT(DISTINCT ?s) AS ?withName)
WHERE { 
    ?s ns:name ?name . 
}

;

# --------------------------------------------------------------------------
# Q2: Sample names by class (Checking ns:name assignment)
# Objetivo: Muestra 10 ejemplos de nombres y la clase a la que pertenecen, verificando la tipificación.
# --------------------------------------------------------------------------
SELECT ?class ?name
WHERE {
    ?s a ?class ;
       ns:name ?name .
}
LIMIT 10

;

# --------------------------------------------------------------------------
# Q3: Count individuals without ns:name (Excluding Measurements and Locations)
# Objetivo: Contar recursos que NO tienen nombre, excluyendo intencionadamente las clases que no lo requieren (Mediciones, Puntos Geográficos y RoadSegments).
# --------------------------------------------------------------------------
SELECT (COUNT(DISTINCT ?s) AS ?withoutName)
WHERE {
    ?s a ?class .
    FILTER NOT EXISTS { ?s ns:name ?name }
    
    # Excluimos recursos sin la propiedad ns:name por diseño de la ontología.
    FILTER (?class != geo:Point)
    FILTER (?class != ns:Measurement)
    FILTER (?class != ns:RoadSegment)
}

;

# --------------------------------------------------------------------------
# Q4: Name distribution by class (Count of named entities)
# Objetivo: Obtener el conteo total de instancias de cada clase que tiene la propiedad ns:name.
# --------------------------------------------------------------------------
SELECT ?class (COUNT(DISTINCT ?s) AS ?count)
WHERE {
    ?s a ?class ;
       ns:name ?name .
}
GROUP BY ?class
ORDER BY DESC(?count)

;

# --------------------------------------------------------------------------
# Q5: Check name readability (using CONTAINS to search for 'sant')
# Objetivo: Verificar que los literales de nombre son legibles y que la función de búsqueda de texto funciona correctamente.
# --------------------------------------------------------------------------
SELECT ?s ?name
WHERE {
    ?s ns:name ?name .
    FILTER(CONTAINS(LCASE(STR(?name)), "sant"))
}
LIMIT 5